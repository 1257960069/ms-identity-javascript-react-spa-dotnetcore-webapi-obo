{
  "Sample": {
    "Title": "A React & Redux single-page application authorizing an ASP.NET Core Web API to call MS Graph API on its behalf using the MS Graph SDK",
    "Level": 200,
    "Client": "React & Redux SPA",
    "Service": "ASP.NET Core Web API",
    "RepositoryUrl": "ms-identity-javascript-react-spa-dotnetcore-webapi-obo",
    "Endpoint": "AAD v2.0"
  },
  "AADApps": [
    {
      "Id": "service",
      "Name": "ProfileAPIandSPA",
      "Kind": "WebApi",
      "HomePage": "https://localhost:44351/",
      "PasswordCredentials": "Auto",
      "RequiredResourcesAccess": [
        {
          "Resource": "Microsoft Graph",
          "DelegatedPermissions": [ "User.Read", "offline_access" ]
        },
        {
					"Resource": "service",
					"DelegatedPermissions": [ "access_as_user" ]
				}
      ],
      "ManualSteps": [
        {
          "Comment": "Navigate to the Authentication blade, click 'Add a platform', choose 'Single-page application' and register your return uri i.e. http://localhost:3000, then enable 'implicit flow' by checking boxes for 'Access Tokens' and 'Id Tokens'"
        },
        {
          "Comment": "Navigate to the Manifest page and change 'signInAudience' to 'AzureADandPersonalMicrosoftAccount'."
        },
        {
          "Comment": "Navigate to the Manifest page and change 'accessTokenAcceptedVersion' to 2."
        }
      ]
    }
  ],
  "CodeConfiguration": [
    {
      "App": "service",
      "SettingKind": "Text",
      "SettingFile": "\\..\\ProfileAPI\\appsettings.json",
      "Mappings": [
        {
          "key": "Domain",
          "value": "$tenantName"
        },
        {
          "key": "ClientId",
          "value": "service.AppId"
        },
        {
          "key": "ClientSecret",
          "value": "service.AppKey"
        }
      ]
    },

    {
      "App": "client",
      "SettingKind": "Replace",
      "SettingFile": "\\..\\ProfileSPA\\src\\utils\\authConfig.js",
      "Mappings": [
        {
          "key": "Enter the Client Id (aka 'Application ID')",
          "value": "service.AppId"
        },
        {
          "key": "Enter the API scopes as declared in the app registration 'Expose an Api' blade in the form of 'api://{client_id}/access_as_user'",
          "value": "'https://'+$tenantName+\"/ProfileAPIandSPA/access_as_user\""
        },
        {
          "key": "Enter the Web APIs base address, e.g. 'https://localhost:44351/api/profile/'",
          "value": "service.Scope"
        }
      ]
    }
  ]
}
